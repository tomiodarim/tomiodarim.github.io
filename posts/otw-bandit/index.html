<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>OverTheWire - Bandit | tomiodarim</title>
<meta name="keywords" content="write-up, overthewire, bandit, linux">
<meta name="description" content="Bandit é um dos wargames do OverTheWire, ele tem a intenção de ensinar o básico de Linux para quem está começando a aprender. São 33 níveis onde é preciso encontrar a senha do SSH do próximo nível, que está escondida na máquina, para avançar.
Este desafio pode ser acessado por meio de SSH no servidor bandit.labs.overthewire.org na porta 2220, o usuário será bandit seguido pelo número do level.
Índice  Level 0 -&gt; Level 1 Level 1 -&gt; Level 2 Level 2 -&gt; Level 3 Level 3 -&gt; Level 4 Level 4 -&gt; Level 5 Level 5 -&gt; Level 6 Level 6 -&gt; Level 7 Level 7 -&gt; Level 8 Level 8 -&gt; Level 9 Level 9 -&gt; Level 10 Level 10 -&gt; Level 11 Level 11 -&gt; Level 12 Level 12 -&gt; Level 13 Level 13 -&gt; Level 14 Level 14 -&gt; Level 15 Level 15 -&gt; Level 16 Level 16 -&gt; Level 17 Level 17 -&gt; Level 18 Level 18 -&gt; Level 19 Level 19 -&gt; Level 20 Level 20 -&gt; Level 21 Level 21 -&gt; Level 22 Level 22 -&gt; Level 23 Level 23 -&gt; Level 24 Level 24 -&gt; Level 25 Level 25 -&gt; Level 26 Level 26 -&gt; Level 27 Level 27 -&gt; Level 28 Level 28 -&gt; Level 29 Level 29 -&gt; Level 30 Level 30 -&gt; Level 31 Level 31 -&gt; Level 32 Level 32 -&gt; Level 33  Level 0 As credenciais para acessar no nível 0 para começar são fornecidas, sendo usuário bandit0 e senha também bandit0.">
<meta name="author" content="Lucas Tomio Darim">
<link rel="canonical" href="https://tomiodarim.github.io/posts/otw-bandit/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5a101feaed2bc000d60de8365173a1aa6c75665853dcc863f92f59ea5ace5d74.css" integrity="sha256-WhAf6u0rwADWDeg2UXOhqmx1ZlhT3Mhj&#43;S9Z6lrOXXQ=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.20cbcab8eadb4b1c256e6db331b0130fc305cd882d8b91865e9b6473e8ec5c24.js" integrity="sha256-IMvKuOrbSxwlbm2zMbATD8MFzYgti5GGXptkc&#43;jsXCQ="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://tomiodarim.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://tomiodarim.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://tomiodarim.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://tomiodarim.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://tomiodarim.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="OverTheWire - Bandit" />
<meta property="og:description" content="Bandit é um dos wargames do OverTheWire, ele tem a intenção de ensinar o básico de Linux para quem está começando a aprender. São 33 níveis onde é preciso encontrar a senha do SSH do próximo nível, que está escondida na máquina, para avançar.
Este desafio pode ser acessado por meio de SSH no servidor bandit.labs.overthewire.org na porta 2220, o usuário será bandit seguido pelo número do level.
Índice  Level 0 -&gt; Level 1 Level 1 -&gt; Level 2 Level 2 -&gt; Level 3 Level 3 -&gt; Level 4 Level 4 -&gt; Level 5 Level 5 -&gt; Level 6 Level 6 -&gt; Level 7 Level 7 -&gt; Level 8 Level 8 -&gt; Level 9 Level 9 -&gt; Level 10 Level 10 -&gt; Level 11 Level 11 -&gt; Level 12 Level 12 -&gt; Level 13 Level 13 -&gt; Level 14 Level 14 -&gt; Level 15 Level 15 -&gt; Level 16 Level 16 -&gt; Level 17 Level 17 -&gt; Level 18 Level 18 -&gt; Level 19 Level 19 -&gt; Level 20 Level 20 -&gt; Level 21 Level 21 -&gt; Level 22 Level 22 -&gt; Level 23 Level 23 -&gt; Level 24 Level 24 -&gt; Level 25 Level 25 -&gt; Level 26 Level 26 -&gt; Level 27 Level 27 -&gt; Level 28 Level 28 -&gt; Level 29 Level 29 -&gt; Level 30 Level 30 -&gt; Level 31 Level 31 -&gt; Level 32 Level 32 -&gt; Level 33  Level 0 As credenciais para acessar no nível 0 para começar são fornecidas, sendo usuário bandit0 e senha também bandit0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://tomiodarim.github.io/posts/otw-bandit/" /><meta property="og:image" content="https://tomiodarim.github.io/papermod-cover.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-14T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-03-14T00:00:00+00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://tomiodarim.github.io/papermod-cover.png"/>

<meta name="twitter:title" content="OverTheWire - Bandit"/>
<meta name="twitter:description" content="Bandit é um dos wargames do OverTheWire, ele tem a intenção de ensinar o básico de Linux para quem está começando a aprender. São 33 níveis onde é preciso encontrar a senha do SSH do próximo nível, que está escondida na máquina, para avançar.
Este desafio pode ser acessado por meio de SSH no servidor bandit.labs.overthewire.org na porta 2220, o usuário será bandit seguido pelo número do level.
Índice  Level 0 -&gt; Level 1 Level 1 -&gt; Level 2 Level 2 -&gt; Level 3 Level 3 -&gt; Level 4 Level 4 -&gt; Level 5 Level 5 -&gt; Level 6 Level 6 -&gt; Level 7 Level 7 -&gt; Level 8 Level 8 -&gt; Level 9 Level 9 -&gt; Level 10 Level 10 -&gt; Level 11 Level 11 -&gt; Level 12 Level 12 -&gt; Level 13 Level 13 -&gt; Level 14 Level 14 -&gt; Level 15 Level 15 -&gt; Level 16 Level 16 -&gt; Level 17 Level 17 -&gt; Level 18 Level 18 -&gt; Level 19 Level 19 -&gt; Level 20 Level 20 -&gt; Level 21 Level 21 -&gt; Level 22 Level 22 -&gt; Level 23 Level 23 -&gt; Level 24 Level 24 -&gt; Level 25 Level 25 -&gt; Level 26 Level 26 -&gt; Level 27 Level 27 -&gt; Level 28 Level 28 -&gt; Level 29 Level 29 -&gt; Level 30 Level 30 -&gt; Level 31 Level 31 -&gt; Level 32 Level 32 -&gt; Level 33  Level 0 As credenciais para acessar no nível 0 para começar são fornecidas, sendo usuário bandit0 e senha também bandit0."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://tomiodarim.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "OverTheWire - Bandit",
      "item": "https://tomiodarim.github.io/posts/otw-bandit/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "OverTheWire - Bandit",
  "name": "OverTheWire - Bandit",
  "description": "Bandit é um dos wargames do OverTheWire, ele tem a intenção de ensinar o básico de Linux para quem está começando a aprender. São 33 níveis onde é preciso encontrar a senha do SSH do próximo nível, que está escondida na máquina, para avançar.\nEste desafio pode ser acessado por meio de SSH no servidor bandit.labs.overthewire.org na porta 2220, o usuário será bandit seguido pelo número do level.\nÍndice  Level 0 -\u0026gt; Level 1 Level 1 -\u0026gt; Level 2 Level 2 -\u0026gt; Level 3 Level 3 -\u0026gt; Level 4 Level 4 -\u0026gt; Level 5 Level 5 -\u0026gt; Level 6 Level 6 -\u0026gt; Level 7 Level 7 -\u0026gt; Level 8 Level 8 -\u0026gt; Level 9 Level 9 -\u0026gt; Level 10 Level 10 -\u0026gt; Level 11 Level 11 -\u0026gt; Level 12 Level 12 -\u0026gt; Level 13 Level 13 -\u0026gt; Level 14 Level 14 -\u0026gt; Level 15 Level 15 -\u0026gt; Level 16 Level 16 -\u0026gt; Level 17 Level 17 -\u0026gt; Level 18 Level 18 -\u0026gt; Level 19 Level 19 -\u0026gt; Level 20 Level 20 -\u0026gt; Level 21 Level 21 -\u0026gt; Level 22 Level 22 -\u0026gt; Level 23 Level 23 -\u0026gt; Level 24 Level 24 -\u0026gt; Level 25 Level 25 -\u0026gt; Level 26 Level 26 -\u0026gt; Level 27 Level 27 -\u0026gt; Level 28 Level 28 -\u0026gt; Level 29 Level 29 -\u0026gt; Level 30 Level 30 -\u0026gt; Level 31 Level 31 -\u0026gt; Level 32 Level 32 -\u0026gt; Level 33  Level 0 As credenciais para acessar no nível 0 para começar são fornecidas, sendo usuário bandit0 e senha também bandit0.",
  "keywords": [
    "write-up", "overthewire", "bandit", "linux"
  ],
  "articleBody": "Bandit é um dos wargames do OverTheWire, ele tem a intenção de ensinar o básico de Linux para quem está começando a aprender. São 33 níveis onde é preciso encontrar a senha do SSH do próximo nível, que está escondida na máquina, para avançar.\nEste desafio pode ser acessado por meio de SSH no servidor bandit.labs.overthewire.org na porta 2220, o usuário será bandit seguido pelo número do level.\nÍndice  Level 0 - Level 1 Level 1 - Level 2 Level 2 - Level 3 Level 3 - Level 4 Level 4 - Level 5 Level 5 - Level 6 Level 6 - Level 7 Level 7 - Level 8 Level 8 - Level 9 Level 9 - Level 10 Level 10 - Level 11 Level 11 - Level 12 Level 12 - Level 13 Level 13 - Level 14 Level 14 - Level 15 Level 15 - Level 16 Level 16 - Level 17 Level 17 - Level 18 Level 18 - Level 19 Level 19 - Level 20 Level 20 - Level 21 Level 21 - Level 22 Level 22 - Level 23 Level 23 - Level 24 Level 24 - Level 25 Level 25 - Level 26 Level 26 - Level 27 Level 27 - Level 28 Level 28 - Level 29 Level 29 - Level 30 Level 30 - Level 31 Level 31 - Level 32 Level 32 - Level 33  Level 0 As credenciais para acessar no nível 0 para começar são fornecidas, sendo usuário bandit0 e senha também bandit0.\nNa home deste usuário já encontramos a senha para o próximo nível no arquivo chamado “readme”, NH2SXQwcBdpmTEzi3bvBHMM9H66vVXjL.\nLevel 1 Agora a senha também está em um arquivo na home, porém o arquivo se chama “-”. Para conseguir printar o conteúdo deste precisa-se passar o caminho com “./-”, caso coloque apenas “-” o interpretador do bash espera por algum parâmetro. A senha encontrada é rRGizSaX8Mk1RTb1CNQoXTcYZWU6lgzi.\nLevel 2 Nesse nível o nome do arquivo possui espaços, para printar podemos utilizar tanto o contrabarra “\", como aspas no nome. aBZ0W5EmUfAf7kHTQeOwd8bauFJ2lAiG\nLevel 3 Caso o nome do arquivo começe com ponto final “.” ele não será mostrado com o comando ls normal, será necessário adicionar o parâmetro “-a”. 2EW7BBsr6aMMoJ2HjW067dm8EgX26xNe\nLevel 4 Agora temos uma pasta com vários arquivo, mas a maioria deles não possui como conteúdo textos. Então utilizando o comando file podemos ver o tipo de conteúdo do arquivo e o asterisco “*” é um coringa que retorna todas as possíveis combinações.\nCom isso podemos ver que apenas o arquivo “-file07” possui texto com o padrão ASCII. lrIWWI6bB37kxfiCQZqUdOIYfr6eEeqR\nLevel 5 Nesse nível é informado que o arquivo contém texto legível, 1033 bytes e não é executável. Com o comando find é possível buscar por certos atributos como tamanho, então utilizando o parâmetro “-size 1033c” podemos buscar por arquivo com o tamanho de 1033 bytes. O ponto final após o find indica que deve começar a buscar a partir do diretório atual e ir recursivamente em todos os diretórios. P4L4vucdmLnm8I7Vl7jG1ApGSfjYKqJU\nLevel 6 Agora foi informado que o arquivo pertence ao usuário bandit7 e ao grupo bandit6. Também com o find podemos buscar por arquivos de determinados usuários ou grupos, o “/” indica para buscar a partir da raiz do sistema de arquivos. z7WtoNQU2XfjmMtWA8u5rN4vzqu4v99S\nLevel 7 Na home deste usuário possui um arquivo chamado “data.txt” que contém mais de 98 mil linhas. É informado que a senha está próxima a palavra “millionth”, então podemos utilizar o grep para filtrar por essa palavra. TESKZC0XvTetK0S9xNwm25STk5iWrBvP\nLevel 8 No arquivo “data.txt”, agora tem várias strings com formato parecido com a senha, mas a senha é a que não se repete. Utilizando o sort podemos ordenar o arquivo para agrupar os repetidos, então com o uniq será impresso na tela apenas uma vez cada e o parâmetro “-c” informa quantas vezes aquela linha está presente.\nCom isso a senha é a única linha que terá 1 ocorrência e não 10 como as demais. EN632PlfYiZbn3PhVK3XOGSlNInNE00t\nLevel 9 Na home temos um “data.txt” que é não é realmente um arquivo de texto, mas a senha será um texto legível dentro desse arquivo e está precedida por alguns sinais de igual “=”. O comando strings é capaz de buscar por textos legíveis dentro de um arquivo binário. G7w8LIi6J3kTb8A7j9LgrywtEUlyyp6s\nLevel 10 O arquivo “data.txt” agora contém um texto que está codificado em Base64, para decodificar há o parâmetro “-d” no comando base64. 6zPeziLdR2RKNdNYFNb6nVCKzphlXHBM\nLevel 11 Agora o texto está codificado utilizando ROT13, que são as letras deslocadas 13 posições no alfabeto. O site CyberChef possui várias operações que podem ser realizadas em texto sendo uma delas ROT13. JVNBBFSmZwKKOP0XbFXOoW8chDz5yVRv\nLevel 12 O “data.txt” desse nível é um hexdump de um arquivo que foi comprimido várias vezes por diferentes algoritmos de compressão. Para resolver esse eu criei uma pasta no diretório /tmp para armazenar os arquivos que fui descomprimindo.\nPrimeiro para ir de hexdump para arquivo binário é só utilizar o comando xxd com o parâmetro “-r”, assim conseguimos o primeiro arquivo que está comprimido em gzip. Para descomprimir de gzip, há o comando gunzip, porém o nome do arquivo deve terminar com o sufixo .gz para que seja possível descomprimir.\nDepois de descomprimir o gzip conseguimos um arquivo comprimido em bzip2, que pode ser descomprimido com o bunzip2. Então, de novo, obtivemos um arquivo de gzip. Descomprimindo resulta em um arquivo comprimido duas vezes em tar, para descomprimir basta utilizar o comando tar com os parâmetros “-xf”. Com isso vem novamente um bzip2.\nDescompactando novamente de tar e de gzip conseguimos, finalmente, um arquivo de texto que contém a senha para o próximo nível. wbWdlBxEir4CaE8LaPhauuOo6pwRmrDw\nLevel 13 Diferente dos níveis anteriores, nesse não coseguimos a senha, entretanto conseguimos a chave privada do SSH.\nCopiando a chave e alterando as permissões dela podemos usá-la como argumento para o parâmetro “-i” do SSH, dessa forma não sendo necessário inserir a senha.\nLevel 14 As senhas de todos os níveis são armazenadas em arquivos no “/etc/bandit_pass” porém apenas o próprio usuário tem a permissão de ver a senha. Como para esse nível entramos com a chave SSH não conseguimos a senha dele e vamos precisar dela para avançar. fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq\nPara conseguir a senha do próximo nível é informado que precisaremos enviar a desse nível para um serviço que está escutando na porta 30000 desse servidor. Utilizando o netcat para fazer a conexão enviamos a senha atual e é retornado a próxima. jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt\nLevel 15 Esse nível é igual ao anterior, mas agora a conexão precisa ser encriptada utilizando o SSL. Ao invés do netcat que usa telnet, usaremos o s_client do openssl para fazer a conexão. Depois é só enviar a senha atual que retorna a próxima. JQttfApK4SeyHwDlI9SXGR50qclOAil1\nLevel 16 Agora precisamos fazer o mesmo que no anterior mas não é informada a porta. Foi informado que está entre a 31000 e a 32000, sendo que alguns serviços nessa faixa apenas retornam o que foi enviado e um deles retorna a senha.\nUtilizando o nmap com o parâmetro “-sV” podemos ver o que está sendo executado em cada porta. Apenas na 31790 não é echo, então é essa que precisamos.\nAo enviar a senha é retornada a chave SSH privada.\nLevel 17 No diretório home do bandit17 há dois arquivos com senhas, um chamado “passwords.new” e outro “passwords.old”, a senha que procuramos é a única que foi modificada no new. Utilizando o comando diff podemos ver as diferenças entre os dois arquivos. Na linha 42 houve uma alteração entre os dois arquivos, sendo a nova senha hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg.\nLevel 18 Ao tentar logar com o SSH somos desconectados, nesse nível. Para que possamos executar comandos na máquina podemos colocá-los após o comando do ssh, assim quando digitarmos a senha o comando será executado na máquina. awhqfNnAbc1naukrpqDYcF95h7HoMTrC\nLevel 19 No diretório home agora temos um executável que nos permite executar os comandos como sendo o bandit20. Com esse programa podemos ler a senha do bandit20 armazenada no “/etc/bandit_pass/bandit20”. VxCazJaVykI6W36BkBU0mJTCM8rR95XT\nLevel 20 O executável que temos agora faz a conexão com alguma porta que seja passada como argumento e caso receba a senha desse nível ele responderá com a senha do próximo. Então para resolver esse desafio precisei conectar na máquina em duas sessões do SSH, em uma delas eu coloquei o netcat para escutar na porta 1234 e na outra utilizei esse executável para fazer a conexão.\nPrimeiro coloquei netcat para escutar utilizando os parâmetros “-lnvp”, onde l é para escutar, n para não resolver o nome do DNS para ip, v para mostrar mais detalhes e p para especificar a porta.\nDepois que o netcat estava ouvindo pude conectar utilizando o suconnect.\nQuando o netcat recebeu a conexão, enviei a senha atual e assim recebi a próxima. NvEJF7oVjkddltPSrdKEFOllh9V1IBcq\nLevel 21 O bandit22 possui uma tarefa que está agendada para executar o script “/usr/bin/cronjob_bandit22.sh” a todo minuto. Olhando o script vemos que está copiando a senha para um arquivo no diretório tmp e está dando permissão para todos lerem. WdDozAdTM2z9DiFEQ2mGlwngMfj4EZff\nLevel 22 Nesse também precisamos olhar um script que está sendo executado com o cron. Esse script copia senha do próprio usuário para um arquivo que o nome é o hash do nome do usuário. Calculando o hash do bandit23 conseguimos printar a senha dele. QYw0Y2aiA672PsMmh9puTQuhoz8SyR2G\nLevel 23 Como os dois anteriores, nesse também há uma tarefa definida no cron. O script desse irá executar e depois deletar todos os scripts que estiverem na pasta “/var/spool/bandit24/foo”. Dessa forma, se colocarmos algum script nesse diretório ele será executado como sendo o bandit24, que é quem criou o cronjob.\nPara conseguir a senha, eu criei um script que irá ler o conteúdo do “/etc/bandit_pass/bandit24” e escrevê-lo em um arquivo que eu criei no “/tmp/lucas/senha”. Dei permissão para que todos os usuários possam executar ou escrever nesses arquivos, logo o bandit24 poderá executar o script que escreverá no arquivo. E por fim copiei o senha.sh para o arquivo que será executado.\nApós alguns segundos a tarefa é executada rodando o script que eu criei. Com um cat podemos ver que a senha está no arquivo. VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar\nLevel 24 Nesse nível há um serviço sendo executado na porta 30002 que retornará a senha do próximo caso seja inserido a senha atual e um pin de 4 dígitos. Precisaremos fazer um brute-force para descobrir o pin, já que pode ser qualquer número de 4 dígitos.\nPara não precisar testar as 10 mil possibilidades na mão, eu criei um script que faça isso. O loop do for irá criar um arquivo chamado “pins” que cada linha terá a senha atual e uma opção de pin. Depois será realizado a conexão utilizando o netcat e enviado uma linha por vez, e o grep filtrará para que não apareçam as mensagens de que o pin está errado. p7TaowMYrmu23Ol8hiZh9UvD0O9hpx8d\nLevel 25 Na home do bandit25 há a chave SSH privada do bandit26 mas ao logar é impresso o texto de aviso na tela e a conexão acaba. Isso acontece pois a shell do bandit26 não é o bash, mas um script para printar o texto com o more.\nCaso o tamanho do terminal não seja o suficiente o more irá parar de printar o texto, dando tempo para a gente executar alguns comandos.\nClicando “v” poderemos executar comandos no vim. E com “:set shell=/bin/bash|:shell” conseguiremos uma shell como bandit26. c7GvcKlw9mC7aUQaPx7nwFstuAIBw1o1\nLevel 26 Agora que temos uma shell interativa como bandit26 podemos prosseguir. Na home há um programa que nos permite executar comandos como bandit27. Com esse programa e com cat podemos ver a senha do bandit27 armazenada. YnQpBuifNMas1hcUFk70ZmqkhUU2EuaS\nLevel 27 Há um repositório de git do usuário bandit27-git que a senha é a mesma que do bandit27. Clonando esse repositório encontramos a senha do próximo armazenada em um arquivo “README”. AVanL161y9rsbcJIsFHuw35rjaOM19nR\nLevel 28 Como o anterior, esse também tem um repositório de git, mas a senha não está sendo mostrada.\nUtilizando o comando git log podemos ver o log de todas as alterações que foram realizadas no repositório. Com o git show vemos quais foram as mudanças realizadas em cada commit. No primeiro deles foi retirada a senha e adicionado os X. tQKvmcwNYcFS6vmPHIUSI3ShmsrQZK8S\nLevel 29 Novamente um repositório de git. Agora a senha também não está no “README.md”. Mas é informado que não tem senha em produção, logo pode haver alguma em uma branch de desenvolvimento. Olhando as branchs encontramos algumas, sendo uma delas chamada “dev”, ao alterar para esse encontramos a senha. xbhV3HpNGlTIdnjUrdAlPzc2L6y9EOnS\nLevel 30 Nesse nível o repositório só possui um arquivo “README.md” e não há nenhum outro commit ou branch. Mas há uma tag na qual está a senha. OoffzGDlzhAlerFJ2cAiz1D41JW1Mhmt\nLevel 31 Por fim o último de git, o “README.md” explica que precisamos fazer o push de um arquivo chamado “key.txt” com o contúdo “May I come in?” para o repositório. Como o “.gitignore” contém *.txt nenhum aquivo com essa extensão poderá ser adicionado, mas isso pode ser ignorado se usarmos o parâmetro “-f” no git add.\nDepois é só fazer o commit e o push e é retornada a senha. rmCBvG56y58BXzv98yZGdO7ATVL5dW8y\nLevel 32 No último desafio somos colocados em uma shell que converte todas as letras para maiúsculas, então não conseguimos utilizar os comandos pois esses são escritos com letras minúsculas. A variável “0”, por padrão, armazena o comando para executar a shell. Então utilizando “$0” nenhum dos caracteres será alterado e o interpretador entenderá que queremos executar “sh”, assim obtemos uma shell normal. odHo63fHiFqcWWJG9rLiLDtPm45KzUKy\nConclusão Aqui terminamos todos os 33 níveis que existem até o momento. Como pode ser visto todos foram sobre comandos básicos de Linux, visto que é um desafio para quem está iniciando. O OverTheWire possui outros Wargames que pretendo fazer o write-up no futuro.\nAgradeço a todos que leram. Qualquer dúvida ou sugestão de melhoria é só entrar em contato.\n",
  "wordCount" : "2295",
  "inLanguage": "en",
  "datePublished": "2023-03-14T00:00:00Z",
  "dateModified": "2023-03-14T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Lucas Tomio Darim"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://tomiodarim.github.io/posts/otw-bandit/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "tomiodarim",
    "logo": {
      "@type": "ImageObject",
      "url": "https://tomiodarim.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://tomiodarim.github.io/" accesskey="h" title="tomiodarim (Alt + H)">tomiodarim</a>
            
        </div>
        <ul id="menu">
            <li>
                <a href="https://tomiodarim.github.io/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://tomiodarim.github.io/aboutme/" title="About Me">
                    <span>About Me</span>
                </a>
            </li>
            <li>
                <a href="https://tomiodarim.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>

            </div>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <h1 class="post-title">
      OverTheWire - Bandit
    </h1>
    <div class="post-meta"><span title='2023-03-14 00:00:00 +0000 UTC'>March 14, 2023</span>&nbsp;·&nbsp;Lucas Tomio Darim

</div>
  </header> 
  <div class="post-content"><p>Bandit é um dos wargames do OverTheWire, ele tem a intenção de ensinar o básico de Linux para quem está começando a aprender. São 33 níveis onde é preciso encontrar a senha do SSH do próximo nível, que está escondida na máquina, para avançar.</p>
<p>Este desafio pode ser acessado por meio de SSH no servidor bandit.labs.overthewire.org na porta 2220, o usuário será bandit seguido pelo número do level.</p>
<h2 id="índice">Índice<a hidden class="anchor" aria-hidden="true" href="#índice">#</a></h2>
<ul>
<li><a href="#level-0">Level 0 -&gt; Level 1</a></li>
<li><a href="#level-1">Level 1 -&gt; Level 2</a></li>
<li><a href="#level-2">Level 2 -&gt; Level 3</a></li>
<li><a href="#level-3">Level 3 -&gt; Level 4</a></li>
<li><a href="#level-4">Level 4 -&gt; Level 5</a></li>
<li><a href="#level-5">Level 5 -&gt; Level 6</a></li>
<li><a href="#level-6">Level 6 -&gt; Level 7</a></li>
<li><a href="#level-7">Level 7 -&gt; Level 8</a></li>
<li><a href="#level-8">Level 8 -&gt; Level 9</a></li>
<li><a href="#level-9">Level 9 -&gt; Level 10</a></li>
<li><a href="#level-10">Level 10 -&gt; Level 11</a></li>
<li><a href="#level-11">Level 11 -&gt; Level 12</a></li>
<li><a href="#level-12">Level 12 -&gt; Level 13</a></li>
<li><a href="#level-13">Level 13 -&gt; Level 14</a></li>
<li><a href="#level-14">Level 14 -&gt; Level 15</a></li>
<li><a href="#level-15">Level 15 -&gt; Level 16</a></li>
<li><a href="#level-16">Level 16 -&gt; Level 17</a></li>
<li><a href="#level-17">Level 17 -&gt; Level 18</a></li>
<li><a href="#level-18">Level 18 -&gt; Level 19</a></li>
<li><a href="#level-19">Level 19 -&gt; Level 20</a></li>
<li><a href="#level-20">Level 20 -&gt; Level 21</a></li>
<li><a href="#level-21">Level 21 -&gt; Level 22</a></li>
<li><a href="#level-22">Level 22 -&gt; Level 23</a></li>
<li><a href="#level-23">Level 23 -&gt; Level 24</a></li>
<li><a href="#level-24">Level 24 -&gt; Level 25</a></li>
<li><a href="#level-25">Level 25 -&gt; Level 26</a></li>
<li><a href="#level-26">Level 26 -&gt; Level 27</a></li>
<li><a href="#level-27">Level 27 -&gt; Level 28</a></li>
<li><a href="#level-28">Level 28 -&gt; Level 29</a></li>
<li><a href="#level-29">Level 29 -&gt; Level 30</a></li>
<li><a href="#level-30">Level 30 -&gt; Level 31</a></li>
<li><a href="#level-31">Level 31 -&gt; Level 32</a></li>
<li><a href="#level-32">Level 32 -&gt; Level 33</a></li>
</ul>
<h3 id="level-0">Level 0<a hidden class="anchor" aria-hidden="true" href="#level-0">#</a></h3>
<p>As credenciais para acessar no nível 0 para começar são fornecidas, sendo usuário bandit0 e senha também bandit0.</p>
<p>Na home deste usuário já encontramos a senha para o próximo nível no arquivo chamado &ldquo;readme&rdquo;, <strong>NH2SXQwcBdpmTEzi3bvBHMM9H66vVXjL</strong>.</p>
<p><img loading="lazy" src="/images/otw-bandit/0.png" alt="0"  />
</p>
<h3 id="level-1">Level 1<a hidden class="anchor" aria-hidden="true" href="#level-1">#</a></h3>
<p>Agora a senha também está em um arquivo na home, porém o arquivo se chama &ldquo;-&rdquo;. Para conseguir printar o conteúdo deste precisa-se passar o caminho com &ldquo;./-&rdquo;, caso coloque apenas &ldquo;-&rdquo; o interpretador do bash espera por algum parâmetro. A senha encontrada é <strong>rRGizSaX8Mk1RTb1CNQoXTcYZWU6lgzi</strong>.</p>
<p><img loading="lazy" src="/images/otw-bandit/1.png" alt="1"  />
</p>
<h3 id="level-2">Level 2<a hidden class="anchor" aria-hidden="true" href="#level-2">#</a></h3>
<p>Nesse nível o nome do arquivo possui espaços, para printar podemos utilizar tanto o contrabarra &ldquo;&quot;, como aspas no nome. <strong>aBZ0W5EmUfAf7kHTQeOwd8bauFJ2lAiG</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/2.png" alt="2"  />
</p>
<h3 id="level-3">Level 3<a hidden class="anchor" aria-hidden="true" href="#level-3">#</a></h3>
<p>Caso o nome do arquivo começe com ponto final &ldquo;.&rdquo; ele não será mostrado com o comando ls normal, será necessário adicionar o parâmetro &ldquo;-a&rdquo;. <strong>2EW7BBsr6aMMoJ2HjW067dm8EgX26xNe</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/3.png" alt="3"  />
</p>
<h3 id="level-4">Level 4<a hidden class="anchor" aria-hidden="true" href="#level-4">#</a></h3>
<p>Agora temos uma pasta com vários arquivo, mas a maioria deles não possui como conteúdo textos. Então utilizando o comando file podemos ver o tipo de conteúdo do arquivo e o asterisco &ldquo;*&rdquo; é um coringa que retorna todas as possíveis combinações.</p>
<p>Com isso podemos ver que apenas o arquivo &ldquo;-file07&rdquo; possui texto com o padrão ASCII. <strong>lrIWWI6bB37kxfiCQZqUdOIYfr6eEeqR</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/4.png" alt="4"  />
</p>
<h3 id="level-5">Level 5<a hidden class="anchor" aria-hidden="true" href="#level-5">#</a></h3>
<p>Nesse nível é informado que o arquivo contém texto legível, 1033 bytes e não é executável. Com o comando find é possível buscar por certos atributos como tamanho, então utilizando o parâmetro &ldquo;-size 1033c&rdquo; podemos buscar por arquivo com o tamanho de 1033 bytes. O ponto final após o find indica que deve começar a buscar a partir do diretório atual e ir recursivamente em todos os diretórios. <strong>P4L4vucdmLnm8I7Vl7jG1ApGSfjYKqJU</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/5.png" alt="5"  />
</p>
<h3 id="level-6">Level 6<a hidden class="anchor" aria-hidden="true" href="#level-6">#</a></h3>
<p>Agora foi informado que o arquivo pertence ao usuário bandit7 e ao grupo bandit6. Também com o find podemos buscar por arquivos de determinados usuários ou grupos, o &ldquo;/&rdquo; indica para buscar a partir da raiz do sistema de arquivos. <strong>z7WtoNQU2XfjmMtWA8u5rN4vzqu4v99S</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/6.png" alt="6"  />
</p>
<h3 id="level-7">Level 7<a hidden class="anchor" aria-hidden="true" href="#level-7">#</a></h3>
<p>Na home deste usuário possui um arquivo chamado &ldquo;data.txt&rdquo; que contém mais de 98 mil linhas. É informado que a senha está próxima a palavra &ldquo;millionth&rdquo;, então podemos utilizar o grep para filtrar por essa palavra. <strong>TESKZC0XvTetK0S9xNwm25STk5iWrBvP</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/7.png" alt="7"  />
</p>
<h3 id="level-8">Level 8<a hidden class="anchor" aria-hidden="true" href="#level-8">#</a></h3>
<p>No arquivo &ldquo;data.txt&rdquo;, agora tem várias strings com formato parecido com a senha, mas a senha é a que não se repete. Utilizando o sort podemos ordenar o arquivo para agrupar os repetidos, então com o uniq será impresso na tela apenas uma vez cada e o parâmetro &ldquo;-c&rdquo; informa quantas vezes aquela linha está presente.</p>
<p>Com isso a senha é a única linha que terá 1 ocorrência e não 10 como as demais. <strong>EN632PlfYiZbn3PhVK3XOGSlNInNE00t</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/8.png" alt="8"  />
</p>
<h3 id="level-9">Level 9<a hidden class="anchor" aria-hidden="true" href="#level-9">#</a></h3>
<p>Na home temos um &ldquo;data.txt&rdquo; que é não é realmente um arquivo de texto, mas a senha será um texto legível dentro desse arquivo e está precedida por alguns sinais de igual &ldquo;=&rdquo;. O comando strings é capaz de buscar por textos legíveis dentro de um arquivo binário. <strong>G7w8LIi6J3kTb8A7j9LgrywtEUlyyp6s</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/9.png" alt="9"  />
</p>
<h3 id="level-10">Level 10<a hidden class="anchor" aria-hidden="true" href="#level-10">#</a></h3>
<p>O arquivo &ldquo;data.txt&rdquo; agora contém um texto que está codificado em Base64, para decodificar há o parâmetro &ldquo;-d&rdquo; no comando base64. <strong>6zPeziLdR2RKNdNYFNb6nVCKzphlXHBM</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/10.png" alt="10"  />
</p>
<h3 id="level-11">Level 11<a hidden class="anchor" aria-hidden="true" href="#level-11">#</a></h3>
<p>Agora o texto está codificado utilizando ROT13, que são as letras deslocadas 13 posições no alfabeto. O site CyberChef possui várias operações que podem ser realizadas em texto sendo uma delas ROT13. <strong>JVNBBFSmZwKKOP0XbFXOoW8chDz5yVRv</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/11.1.png" alt="11.1"  />
</p>
<p><img loading="lazy" src="/images/otw-bandit/11.2.png" alt="11.2"  />
</p>
<h3 id="level-12">Level 12<a hidden class="anchor" aria-hidden="true" href="#level-12">#</a></h3>
<p>O &ldquo;data.txt&rdquo; desse nível é um hexdump de um arquivo que foi comprimido várias vezes por diferentes algoritmos de compressão. Para resolver esse eu criei uma pasta no diretório /tmp para armazenar os arquivos que fui descomprimindo.</p>
<p>Primeiro para ir de hexdump para arquivo binário é só utilizar o comando xxd com o parâmetro &ldquo;-r&rdquo;, assim conseguimos o primeiro arquivo que está comprimido em gzip. Para descomprimir de gzip, há o comando gunzip, porém o nome do arquivo deve terminar com o sufixo .gz para que seja possível descomprimir.</p>
<p>Depois de descomprimir o gzip conseguimos um arquivo comprimido em bzip2, que pode ser descomprimido com o bunzip2. Então, de novo, obtivemos um arquivo de gzip. Descomprimindo resulta em um arquivo comprimido duas vezes em tar, para descomprimir basta utilizar o comando tar com os parâmetros &ldquo;-xf&rdquo;. Com isso vem novamente um bzip2.</p>
<p><img loading="lazy" src="/images/otw-bandit/12.1.png" alt="12.1"  />
</p>
<p>Descompactando novamente de tar e de gzip conseguimos, finalmente, um arquivo de texto que contém a senha para o próximo nível. <strong>wbWdlBxEir4CaE8LaPhauuOo6pwRmrDw</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/12.2.png" alt="12.2"  />
</p>
<h3 id="level-13">Level 13<a hidden class="anchor" aria-hidden="true" href="#level-13">#</a></h3>
<p>Diferente dos níveis anteriores, nesse não coseguimos a senha, entretanto conseguimos a chave privada do SSH.</p>
<p><img loading="lazy" src="/images/otw-bandit/13.1.png" alt="13.1"  />
</p>
<p>Copiando a chave e alterando as permissões dela podemos usá-la como argumento para o parâmetro &ldquo;-i&rdquo; do SSH, dessa forma não sendo necessário inserir a senha.</p>
<p><img loading="lazy" src="/images/otw-bandit/13.2.png" alt="13.2"  />
</p>
<h3 id="level-14">Level 14<a hidden class="anchor" aria-hidden="true" href="#level-14">#</a></h3>
<p>As senhas de todos os níveis são armazenadas em arquivos no &ldquo;/etc/bandit_pass&rdquo; porém apenas o próprio usuário tem a permissão de ver a senha. Como para esse nível entramos com a chave SSH não conseguimos a senha dele e vamos precisar dela para avançar. <strong>fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/14.1.png" alt="14.1"  />
</p>
<p>Para conseguir a senha do próximo nível é informado que precisaremos enviar a desse nível para um serviço que está escutando na porta 30000 desse servidor. Utilizando o netcat para fazer a conexão enviamos a senha atual e é retornado a próxima. <strong>jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/14.2.png" alt="14.2"  />
</p>
<h3 id="level-15">Level 15<a hidden class="anchor" aria-hidden="true" href="#level-15">#</a></h3>
<p>Esse nível é igual ao anterior, mas agora a conexão precisa ser encriptada utilizando o SSL. Ao invés do netcat que usa telnet, usaremos o s_client do openssl para fazer a conexão. Depois é só enviar a senha atual que retorna a próxima. <strong>JQttfApK4SeyHwDlI9SXGR50qclOAil1</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/15.png" alt="15"  />
</p>
<h3 id="level-16">Level 16<a hidden class="anchor" aria-hidden="true" href="#level-16">#</a></h3>
<p>Agora precisamos fazer o mesmo que no anterior mas não é informada a porta. Foi informado que está entre a 31000 e a 32000, sendo que alguns serviços nessa faixa apenas retornam o que foi enviado e um deles retorna a senha.</p>
<p>Utilizando o nmap com o parâmetro &ldquo;-sV&rdquo; podemos ver o que está sendo executado em cada porta. Apenas na 31790 não é echo, então é essa que precisamos.</p>
<p><img loading="lazy" src="/images/otw-bandit/16.1.png" alt="16.1"  />
</p>
<p>Ao enviar a senha é retornada a chave SSH privada.</p>
<p><img loading="lazy" src="/images/otw-bandit/16.2.png" alt="16.2"  />
</p>
<h3 id="level-17">Level 17<a hidden class="anchor" aria-hidden="true" href="#level-17">#</a></h3>
<p>No diretório home do bandit17 há dois arquivos com senhas, um chamado &ldquo;passwords.new&rdquo; e outro &ldquo;passwords.old&rdquo;, a senha que procuramos é a única que foi modificada no new. Utilizando o comando diff podemos ver as diferenças entre os dois arquivos. Na linha 42 houve uma alteração entre os dois arquivos, sendo a nova senha <strong>hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg</strong>.</p>
<p><img loading="lazy" src="/images/otw-bandit/17.png" alt="17"  />
</p>
<h3 id="level-18">Level 18<a hidden class="anchor" aria-hidden="true" href="#level-18">#</a></h3>
<p>Ao tentar logar com o SSH somos desconectados, nesse nível. Para que possamos executar comandos na máquina podemos colocá-los após o comando do ssh, assim quando digitarmos a senha o comando será executado na máquina. <strong>awhqfNnAbc1naukrpqDYcF95h7HoMTrC</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/18.png" alt="18"  />
</p>
<h3 id="level-19">Level 19<a hidden class="anchor" aria-hidden="true" href="#level-19">#</a></h3>
<p>No diretório home agora temos um executável que nos permite executar os comandos como sendo o bandit20. Com esse programa podemos ler a senha do bandit20 armazenada no &ldquo;/etc/bandit_pass/bandit20&rdquo;. <strong>VxCazJaVykI6W36BkBU0mJTCM8rR95XT</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/19.png" alt="19"  />
</p>
<h3 id="level-20">Level 20<a hidden class="anchor" aria-hidden="true" href="#level-20">#</a></h3>
<p>O executável que temos agora faz a conexão com alguma porta que seja passada como argumento e caso receba a senha desse nível ele responderá com a senha do próximo. Então para resolver esse desafio precisei conectar na máquina em duas sessões do SSH, em uma delas eu coloquei o netcat para escutar na porta 1234 e na outra utilizei esse executável para fazer a conexão.</p>
<p>Primeiro coloquei netcat para escutar utilizando os parâmetros &ldquo;-lnvp&rdquo;, onde l é para escutar, n para não resolver o nome do DNS para ip, v para mostrar mais detalhes e p para especificar a porta.</p>
<p><img loading="lazy" src="/images/otw-bandit/20.2.png" alt="20.2"  />
</p>
<p>Depois que o netcat estava ouvindo pude conectar utilizando o suconnect.</p>
<p><img loading="lazy" src="/images/otw-bandit/20.1.png" alt="20.1"  />
</p>
<p>Quando o netcat recebeu a conexão, enviei a senha atual e assim recebi a próxima. <strong>NvEJF7oVjkddltPSrdKEFOllh9V1IBcq</strong></p>
<h3 id="level-21">Level 21<a hidden class="anchor" aria-hidden="true" href="#level-21">#</a></h3>
<p>O bandit22 possui uma tarefa que está agendada para executar o script &ldquo;/usr/bin/cronjob_bandit22.sh&rdquo; a todo minuto. Olhando o script vemos que está copiando a senha para um arquivo no diretório tmp e está dando permissão para todos lerem. <strong>WdDozAdTM2z9DiFEQ2mGlwngMfj4EZff</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/21.png" alt="21"  />
</p>
<h3 id="level-22">Level 22<a hidden class="anchor" aria-hidden="true" href="#level-22">#</a></h3>
<p>Nesse também precisamos olhar um script que está sendo executado com o cron. Esse script copia senha do próprio usuário para um arquivo que o nome é o hash do nome do usuário. Calculando o hash do bandit23 conseguimos printar a senha dele. <strong>QYw0Y2aiA672PsMmh9puTQuhoz8SyR2G</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/22.png" alt="22"  />
</p>
<h3 id="level-23">Level 23<a hidden class="anchor" aria-hidden="true" href="#level-23">#</a></h3>
<p>Como os dois anteriores, nesse também há uma tarefa definida no cron. O script desse irá executar e depois deletar todos os scripts que estiverem na pasta &ldquo;/var/spool/bandit24/foo&rdquo;. Dessa forma, se colocarmos algum script nesse diretório ele será executado como sendo o bandit24, que é quem criou o cronjob.</p>
<p><img loading="lazy" src="/images/otw-bandit/23.1.png" alt="23.1"  />
</p>
<p>Para conseguir a senha, eu criei um script que irá ler o conteúdo do &ldquo;/etc/bandit_pass/bandit24&rdquo; e escrevê-lo em um arquivo que eu criei no &ldquo;/tmp/lucas/senha&rdquo;. Dei permissão para que todos os usuários possam executar ou escrever nesses arquivos, logo o bandit24 poderá executar o script que escreverá no arquivo. E por fim copiei o senha.sh para o arquivo que será executado.</p>
<p><img loading="lazy" src="/images/otw-bandit/23.2.png" alt="23.2"  />
</p>
<p>Após alguns segundos a tarefa é executada rodando o script que eu criei. Com um cat podemos ver que a senha está no arquivo. <strong>VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/23.3.png" alt="23.3"  />
</p>
<h3 id="level-24">Level 24<a hidden class="anchor" aria-hidden="true" href="#level-24">#</a></h3>
<p>Nesse nível há um serviço sendo executado na porta 30002 que retornará a senha do próximo caso seja inserido a senha atual e um pin de 4 dígitos. Precisaremos fazer um brute-force para descobrir o pin, já que pode ser qualquer número de 4 dígitos.</p>
<p>Para não precisar testar as 10 mil possibilidades na mão, eu criei um script que faça isso. O loop do for irá criar um arquivo chamado &ldquo;pins&rdquo; que cada linha terá a senha atual e uma opção de pin. Depois será realizado a conexão utilizando o netcat e enviado uma linha por vez, e o grep filtrará para que não apareçam as mensagens de que o pin está errado. <strong>p7TaowMYrmu23Ol8hiZh9UvD0O9hpx8d</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/24.png" alt="24"  />
</p>
<h3 id="level-25">Level 25<a hidden class="anchor" aria-hidden="true" href="#level-25">#</a></h3>
<p>Na home do bandit25 há a chave SSH privada do bandit26 mas ao logar é impresso o texto de aviso na tela e a conexão acaba. Isso acontece pois a shell do bandit26 não é o bash, mas um script para printar o texto com o more.</p>
<p><img loading="lazy" src="/images/otw-bandit/25.1.png" alt="25.1"  />
</p>
<p>Caso o tamanho do terminal não seja o suficiente o more irá parar de printar o texto, dando tempo para a gente executar alguns comandos.</p>
<p><img loading="lazy" src="/images/otw-bandit/25.2.png" alt="25.1"  />
</p>
<p>Clicando &ldquo;v&rdquo; poderemos executar comandos no vim. E com &ldquo;:set shell=/bin/bash|:shell&rdquo; conseguiremos uma shell como bandit26. <strong>c7GvcKlw9mC7aUQaPx7nwFstuAIBw1o1</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/25.3.png" alt="25.1"  />
</p>
<h3 id="level-26">Level 26<a hidden class="anchor" aria-hidden="true" href="#level-26">#</a></h3>
<p>Agora que temos uma shell interativa como bandit26 podemos prosseguir. Na home há um programa que nos permite executar comandos como bandit27. Com esse programa e com cat podemos ver a senha do bandit27 armazenada. <strong>YnQpBuifNMas1hcUFk70ZmqkhUU2EuaS</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/26.png" alt="26"  />
</p>
<h3 id="level-27">Level 27<a hidden class="anchor" aria-hidden="true" href="#level-27">#</a></h3>
<p>Há um repositório de git do usuário bandit27-git que a senha é a mesma que do bandit27. Clonando esse repositório encontramos a senha do próximo armazenada em um arquivo &ldquo;README&rdquo;. <strong>AVanL161y9rsbcJIsFHuw35rjaOM19nR</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/27.png" alt="27"  />
</p>
<h3 id="level-28">Level 28<a hidden class="anchor" aria-hidden="true" href="#level-28">#</a></h3>
<p>Como o anterior, esse também tem um repositório de git, mas a senha não está sendo mostrada.</p>
<p><img loading="lazy" src="/images/otw-bandit/28.1.png" alt="28"  />
</p>
<p>Utilizando o comando git log podemos ver o log de todas as alterações que foram realizadas no repositório. Com o git show vemos quais foram as mudanças realizadas em cada commit. No primeiro deles foi retirada a senha e adicionado os X. <strong>tQKvmcwNYcFS6vmPHIUSI3ShmsrQZK8S</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/28.2.png" alt="28.2"  />
</p>
<h3 id="level-29">Level 29<a hidden class="anchor" aria-hidden="true" href="#level-29">#</a></h3>
<p>Novamente um repositório de git. Agora a senha também não está no &ldquo;README.md&rdquo;. Mas é informado que não tem senha em produção, logo pode haver alguma em uma branch de desenvolvimento. Olhando as branchs encontramos algumas, sendo uma delas chamada &ldquo;dev&rdquo;, ao alterar para esse encontramos a senha. <strong>xbhV3HpNGlTIdnjUrdAlPzc2L6y9EOnS</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/29.png" alt="29"  />
</p>
<h3 id="level-30">Level 30<a hidden class="anchor" aria-hidden="true" href="#level-30">#</a></h3>
<p>Nesse nível o repositório só possui um arquivo &ldquo;README.md&rdquo; e não há nenhum outro commit ou branch. Mas há uma tag na qual está a senha. <strong>OoffzGDlzhAlerFJ2cAiz1D41JW1Mhmt</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/30.png" alt="30"  />
</p>
<h3 id="level-31">Level 31<a hidden class="anchor" aria-hidden="true" href="#level-31">#</a></h3>
<p>Por fim o último de git, o &ldquo;README.md&rdquo; explica que precisamos fazer o push de um arquivo chamado &ldquo;key.txt&rdquo; com o contúdo &ldquo;May I come in?&rdquo; para o repositório. Como o &ldquo;.gitignore&rdquo; contém *.txt nenhum aquivo com essa extensão poderá ser adicionado, mas isso pode ser ignorado se usarmos o parâmetro &ldquo;-f&rdquo; no git add.</p>
<p><img loading="lazy" src="/images/otw-bandit/31.1.png" alt="31.1"  />
</p>
<p>Depois é só fazer o commit e o push e é retornada a senha. <strong>rmCBvG56y58BXzv98yZGdO7ATVL5dW8y</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/31.2.png" alt="31.2"  />
</p>
<h3 id="level-32">Level 32<a hidden class="anchor" aria-hidden="true" href="#level-32">#</a></h3>
<p>No último desafio somos colocados em uma shell que converte todas as letras para maiúsculas, então não conseguimos utilizar os comandos pois esses são escritos com letras minúsculas. A variável &ldquo;0&rdquo;, por padrão, armazena o comando para executar a shell. Então utilizando &ldquo;$0&rdquo; nenhum dos caracteres será alterado e o interpretador entenderá que queremos executar &ldquo;sh&rdquo;, assim obtemos uma shell normal. <strong>odHo63fHiFqcWWJG9rLiLDtPm45KzUKy</strong></p>
<p><img loading="lazy" src="/images/otw-bandit/32.png" alt="32"  />
</p>
<h2 id="conclusão">Conclusão<a hidden class="anchor" aria-hidden="true" href="#conclusão">#</a></h2>
<p>Aqui terminamos todos os 33 níveis que existem até o momento. Como pode ser visto todos foram sobre comandos básicos de Linux, visto que é um desafio para quem está iniciando. O OverTheWire possui outros Wargames que pretendo fazer o write-up no futuro.</p>
<p>Agradeço a todos que leram. Qualquer dúvida ou sugestão de melhoria é só entrar em contato.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      tags:
      <li><a href="https://tomiodarim.github.io/tags/write-up/">write-up</a></li>
      <li><a href="https://tomiodarim.github.io/tags/overthewire/">overthewire</a></li>
      <li><a href="https://tomiodarim.github.io/tags/bandit/">bandit</a></li>
      <li><a href="https://tomiodarim.github.io/tags/linux/">linux</a></li>
    </ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>Lucas Tomio Darim · &copy; 2023</span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
